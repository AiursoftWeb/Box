# Not Trusted
chat.aiursoft.com {
    log
    import hsts
    import rate_limit
    encode br gzip

    @insider {
            remote_ip 192.168.50.0/24 172.18.0.0/16
    }
    handle @insider {
        reverse_proxy http://ai_ollama-gateway:5000 {
        }
    }

    route {
        reverse_proxy /outpost.goauthentik.io/* http://ai_authentik_proxy:9000 {
            header_up Host {http.reverse_proxy.upstream.host}
        }

        forward_auth http://ai_authentik_proxy:9000 {
            uri     /outpost.goauthentik.io/auth/caddy
            copy_headers X-Authentik-Username X-Authentik-Groups X-Authentik-Entitlements X-Authentik-Email X-Authentik-Name X-Authentik-Uid X-Authentik-Jwt X-Authentik-Meta-Jwks X-Authentik-Meta-Outpost X-Authentik-Meta-Provider X-Authentik-Meta-App X-Authentik-Meta-Version
        }

        reverse_proxy http://ai_ollama-gateway:5000
    }
}

# Untrusted
openweb.aiursoft.com {
    log
    import hsts
    import rate_limit
    encode br gzip
    reverse_proxy http://ai_open-webui:8080
}

# Untrusted
openweb.aiursoft.cn {
    log
    import hsts
    import rate_limit
    encode br gzip
    redir https://openweb.aiursoft.com{uri} permanent
}


